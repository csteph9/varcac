import{r as p,o as F,n as L,c as r,a as l,b as n,u as a,d as y,q as S,e as d,C as U,F as b,g as w,f as E,h as R,i as V,k as s,t as i,l as H}from"./index-CFGD_Gi7.js";import{C as P}from"./CButton-Bar-IVn5.js";import{C as $}from"./CCardHeader-j1dVyNP9.js";import{C as k}from"./CFormInput-vGO62AtJ.js";import{C as T}from"./CFormSelect-BXUyUJls.js";import{C as j,a as m}from"./CRow-CQIQrd1B.js";import{C as M}from"./CSpinner-B_QOP7IZ.js";import{C as z,a as G,b as x,c as v,d as J,e as _}from"./CTable-D8-Qdao0.js";const K={class:"p-3"},O=["value"],Q=["value"],W={key:0,class:"py-3"},X={key:1},Y=["onClick"],Z={key:0,class:"text-muted"},se={__name:"DataList",setup(h){const c=p(!0),f=p([]),D=p([]),I=p([]),o=p({participantId:"",elementDefinitionId:"",from:"",to:"",q:""}),B=async()=>{const[u,e]=await Promise.all([V.get("/api/participants",{withCredentials:!0}),V.get("/api/element-definitions",{withCredentials:!0})]);D.value=u.data||[],I.value=e.data||[]},g=async()=>{c.value=!0;try{const u={};o.value.participantId&&(u.participantId=o.value.participantId),o.value.elementDefinitionId&&(u.elementDefinitionId=o.value.elementDefinitionId),o.value.from&&(u.from=o.value.from),o.value.to&&(u.to=o.value.to);const{data:e}=await V.get("/api/metrics",{params:u,withCredentials:!0});f.value=e||[]}finally{c.value=!1}};F(async()=>{await B(),await g()});const q=()=>g(),N=L(()=>{const u=o.value.q.trim().toLowerCase();return u?f.value.filter(e=>{var C;return[e.firstName,e.lastName,e.elementName,e.elementType,e.unit,(C=e.value)==null?void 0:C.toString()].filter(Boolean).some(t=>t.toLowerCase().includes(u))}):f.value}),A=async u=>{confirm("Delete this value?")&&(await V.delete(`/api/metrics/${u}`,{withCredentials:!0}),f.value=f.value.filter(e=>e.id!==u))};return(u,e)=>{const C=S("router-link");return s(),r("div",K,[l(a(R),null,{default:n(()=>[l(a($),{class:"fw-semibold d-flex align-items-center justify-content-between"},{default:n(()=>[e[6]||(e[6]=y("span",null,"Loaded Data",-1)),l(C,{class:"btn btn-sm btn-primary",to:{name:"DataEntry"}},{default:n(()=>e[5]||(e[5]=[d("Add Value",-1)])),_:1,__:[5]})]),_:1,__:[6]}),l(a(U),null,{default:n(()=>[l(a(j),{class:"g-3 mb-3"},{default:n(()=>[l(a(m),{md:"3"},{default:n(()=>[l(a(T),{modelValue:o.value.participantId,"onUpdate:modelValue":e[0]||(e[0]=t=>o.value.participantId=t)},{default:n(()=>[e[7]||(e[7]=y("option",{value:""},"All Participants",-1)),(s(!0),r(b,null,w(D.value,t=>(s(),r("option",{key:t.id,value:t.id},i(t.firstName)+" "+i(t.lastName)+" ("+i(t.employeeId)+") ",9,O))),128))]),_:1,__:[7]},8,["modelValue"])]),_:1}),l(a(m),{md:"3"},{default:n(()=>[l(a(T),{modelValue:o.value.elementDefinitionId,"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.elementDefinitionId=t)},{default:n(()=>[e[8]||(e[8]=y("option",{value:""},"All Elements",-1)),(s(!0),r(b,null,w(I.value,t=>(s(),r("option",{key:t.id,value:t.id},i(t.name)+" ("+i(t.elementType)+") ",9,Q))),128))]),_:1,__:[8]},8,["modelValue"])]),_:1}),l(a(m),{md:"2"},{default:n(()=>[l(a(k),{type:"date",modelValue:o.value.from,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.from=t),placeholder:"From"},null,8,["modelValue"])]),_:1}),l(a(m),{md:"2"},{default:n(()=>[l(a(k),{type:"date",modelValue:o.value.to,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.to=t),placeholder:"To"},null,8,["modelValue"])]),_:1}),l(a(m),{md:"2",class:"d-flex gap-2"},{default:n(()=>[l(a(P),{color:"secondary",onClick:q},{default:n(()=>e[9]||(e[9]=[d("Apply",-1)])),_:1,__:[9]})]),_:1}),l(a(m),{md:"6"},{default:n(()=>[l(a(k),{modelValue:o.value.q,"onUpdate:modelValue":e[4]||(e[4]=t=>o.value.q=t),placeholder:"Search text..."},null,8,["modelValue"])]),_:1})]),_:1}),c.value?(s(),r("div",W,[l(a(M))])):(s(),r("div",X,[l(a(z),{hover:"",responsive:""},{default:n(()=>[l(a(G),null,{default:n(()=>[l(a(x),null,{default:n(()=>[l(a(v),null,{default:n(()=>e[10]||(e[10]=[d("Participant",-1)])),_:1,__:[10]}),l(a(v),null,{default:n(()=>e[11]||(e[11]=[d("Element",-1)])),_:1,__:[11]}),l(a(v),null,{default:n(()=>e[12]||(e[12]=[d("Date",-1)])),_:1,__:[12]}),l(a(v),null,{default:n(()=>e[13]||(e[13]=[d("Value",-1)])),_:1,__:[13]}),l(a(v),null,{default:n(()=>e[14]||(e[14]=[d("Actions",-1)])),_:1,__:[14]})]),_:1})]),_:1}),l(a(J),null,{default:n(()=>[(s(!0),r(b,null,w(N.value,t=>(s(),H(a(x),{key:t.id},{default:n(()=>[l(a(_),null,{default:n(()=>[d(i(t.firstName)+" "+i(t.lastName),1)]),_:2},1024),l(a(_),null,{default:n(()=>[d(i(t.elementName)+" ("+i(t.elementType)+" Â· "+i(t.unit)+")",1)]),_:2},1024),l(a(_),null,{default:n(()=>[d(i(t.metricDate),1)]),_:2},1024),l(a(_),null,{default:n(()=>[d(i(t.value),1)]),_:2},1024),l(a(_),null,{default:n(()=>[y("button",{class:"btn btn-sm btn-danger",onClick:ee=>A(t.id)},"Delete",8,Y)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1}),N.value.length===0?(s(),r("div",Z,"No data yet.")):E("",!0)]))]),_:1})]),_:1})])}}};export{se as default};
