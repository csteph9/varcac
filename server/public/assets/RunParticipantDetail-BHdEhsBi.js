import{r as I,o as R,c as o,a,b as t,u as e,d as g,e as l,f as k,t as u,v as V,F as c,R as F,C as S,g as C,h as E,i as L,k as d,l as N}from"./index-DPzvZzfM.js";import{C as T}from"./CBadge-CezT8RGM.js";import{C as P}from"./CCardHeader-CyVR9a-w.js";import{C as H}from"./CSpinner-4RQXIVOv.js";import{C as w,a as B,b as v,c as i,d as D,e as m}from"./CTable-DK-5-MOF.js";const M={class:"p-3"},U={key:0},$={key:1,class:"text-danger"},j={key:2},q={key:0,class:"text-muted"},z={class:"mb-2"},X={__name:"RunParticipantDetail",setup(A){const p=V(),s=I({loading:!0,run:null,error:null}),y=f=>Number(f||0).toLocaleString(void 0,{style:"currency",currency:"USD",maximumFractionDigits:2});return R(async()=>{s.value.loading=!0,s.value.error=null;try{const{data:f}=await L.get(`/api/runs/${p.params.runId}/participants/${p.params.participantId}/results`,{withCredentials:!0});s.value.run=f}catch(f){console.error(f),s.value.error="Failed to load run detail"}finally{s.value.loading=!1}}),(f,n)=>(d(),o("div",M,[a(e(E),null,{default:t(()=>[a(e(P),{class:"fw-semibold d-flex justify-content-between align-items-center"},{default:t(()=>[g("span",null,[l(" Run #"+u(e(p).params.runId)+" — Participant #"+u(e(p).params.participantId)+" ",1),s.value.run?(d(),o(c,{key:0},[l(" • "+u(s.value.run.plan.planName)+" ",1),a(e(T),{color:"secondary"},{default:t(()=>[l("v"+u(s.value.run.plan.planVersion),1)]),_:1}),a(e(T),{color:"info",class:"ms-2"},{default:t(()=>[l(u(s.value.run.plan.payoutFrequency),1)]),_:1})],64)):k("",!0)]),a(e(F),{class:"btn btn-sm btn-outline-primary",to:{name:"ParticipantsList"}},{default:t(()=>n[0]||(n[0]=[l("Back to Participants",-1)])),_:1,__:[0]})]),_:1}),a(e(S),null,{default:t(()=>{var b,x;return[s.value.loading?(d(),o("div",U,[a(e(H))])):s.value.error?(d(),o("div",$,u(s.value.error),1)):(d(),o("div",j,[(x=(b=s.value.run)==null?void 0:b.periods)!=null&&x.length?k("",!0):(d(),o("div",q,"No rows in this run.")),(d(!0),o(c,null,C(s.value.run.periods,_=>(d(),o("div",{key:_.periodStart,class:"mb-4"},[g("h6",z,u(_.periodStart)+" — Total: "+u(y(_.total)),1),a(e(w),{small:"",responsive:"",hover:"",class:"mb-2"},{default:t(()=>[a(e(B),null,{default:t(()=>[a(e(v),null,{default:t(()=>[a(e(i),null,{default:t(()=>n[1]||(n[1]=[l("Element",-1)])),_:1,__:[1]}),a(e(i),{class:"text-end"},{default:t(()=>n[2]||(n[2]=[l("Total",-1)])),_:1,__:[2]})]),_:1})]),_:1}),a(e(D),null,{default:t(()=>[(d(!0),o(c,null,C(_.byElement,r=>(d(),N(e(v),{key:r.elementId},{default:t(()=>[a(e(m),null,{default:t(()=>[l(u(r.elementName),1)]),_:2},1024),a(e(m),{class:"text-end"},{default:t(()=>[l(u(y(r.total)),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024),a(e(w),{small:"",responsive:"",hover:""},{default:t(()=>[a(e(B),null,{default:t(()=>[a(e(v),null,{default:t(()=>[a(e(i),null,{default:t(()=>n[3]||(n[3]=[l("Date",-1)])),_:1,__:[3]}),a(e(i),null,{default:t(()=>n[4]||(n[4]=[l("Element",-1)])),_:1,__:[4]}),a(e(i),{class:"text-end"},{default:t(()=>n[5]||(n[5]=[l("Input",-1)])),_:1,__:[5]}),a(e(i),null,{default:t(()=>n[6]||(n[6]=[l("Rate",-1)])),_:1,__:[6]}),a(e(i),null,{default:t(()=>n[7]||(n[7]=[l("Formula Used",-1)])),_:1,__:[7]}),a(e(i),{class:"text-end"},{default:t(()=>n[8]||(n[8]=[l("Computed",-1)])),_:1,__:[8]})]),_:1})]),_:1}),a(e(D),null,{default:t(()=>[(d(!0),o(c,null,C(_.items,r=>(d(),N(e(v),{key:r.metricDate+"-"+r.elementId},{default:t(()=>[a(e(m),null,{default:t(()=>[l(u(r.metricDate),1)]),_:2},1024),a(e(m),null,{default:t(()=>[l(u(r.elementName),1)]),_:2},1024),a(e(m),{class:"text-end"},{default:t(()=>[l(u(r.inputValue),1)]),_:2},1024),a(e(m),null,{default:t(()=>[l(u(r.rate??"—"),1)]),_:2},1024),a(e(m),{class:"text-truncate",style:{"max-width":"360px"}},{default:t(()=>[l(u(r.formula||"default"),1)]),_:2},1024),a(e(m),{class:"text-end"},{default:t(()=>[l(u(y(r.computedValue)),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]))),128))]))]}),_:1})]),_:1})]))}};export{X as default};
