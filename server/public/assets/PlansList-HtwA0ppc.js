import{r as p,o as T,w as x,c as v,a as l,b as a,u as t,d as E,e as n,C as P,f as $,F as D,g as N,t as u,h as S,i as c,j as V,k as f,l as F,m as w}from"./index-CQNOpYTI.js";import{C}from"./CButton-17-Jpi_Q.js";import{C as H}from"./CButtonGroup-BuRj9J89.js";import{C as L}from"./CCardHeader-BWvtasq5.js";import{C as j}from"./CSpinner-EBzRx-qA.js";import{C as z,a as M,b as g,c as i,d as R,e as d}from"./CTable-DqhvKdog.js";const q={class:"p-3"},G={key:0,class:"py-3"},I={key:1},J={key:0,class:"text-muted"},Z={__name:"PlansList",setup(K){const A=V(),m=p(!0),_=p([]),r=p(!0),y=async()=>{m.value=!0;try{const{data:o}=await c.get(`/api/plans?isActive=${r.value?1:0}`,{withCredentials:!0});_.value=Array.isArray(o)?o:[]}finally{m.value=!1}};T(y),x(r,y);const b=o=>A.push({name:"PlanDetail",params:{id:o}}),B=async o=>{if(confirm("Delete this plan? All attached elements will be detached. This cannot be undone."))try{await c.delete(`/api/plans/${o}`,{withCredentials:!0}),_.value=_.value.filter(e=>e.id!==o)}catch(e){console.error(e),alert("Error deleting plan.")}};return(o,e)=>(f(),v("div",q,[l(t(S),null,{default:a(()=>[l(t(L),{class:"fw-semibold d-flex align-items-center justify-content-between"},{default:a(()=>[e[4]||(e[4]=E("span",null,"Plans",-1)),l(t(H),{size:"sm"},{default:a(()=>[l(t(C),{color:r.value?"primary":"secondary",onClick:e[0]||(e[0]=s=>r.value=!0)},{default:a(()=>e[2]||(e[2]=[n("Active",-1)])),_:1,__:[2]},8,["color"]),l(t(C),{color:r.value?"secondary":"primary",onClick:e[1]||(e[1]=s=>r.value=!1)},{default:a(()=>e[3]||(e[3]=[n("Archived",-1)])),_:1,__:[3]},8,["color"])]),_:1})]),_:1,__:[4]}),l(t(P),null,{default:a(()=>[m.value?(f(),v("div",G,[l(t(j))])):(f(),v("div",I,[l(t(z),{hover:"",responsive:""},{default:a(()=>[l(t(M),null,{default:a(()=>[l(t(g),null,{default:a(()=>[l(t(i),null,{default:a(()=>e[5]||(e[5]=[n("Name",-1)])),_:1,__:[5]}),l(t(i),null,{default:a(()=>e[6]||(e[6]=[n("Version",-1)])),_:1,__:[6]}),l(t(i),null,{default:a(()=>e[7]||(e[7]=[n("Effective Start",-1)])),_:1,__:[7]}),l(t(i),null,{default:a(()=>e[8]||(e[8]=[n("Effective End",-1)])),_:1,__:[8]}),l(t(i),null,{default:a(()=>e[9]||(e[9]=[n("Payout",-1)])),_:1,__:[9]}),l(t(i),null,{default:a(()=>e[10]||(e[10]=[n("Created",-1)])),_:1,__:[10]}),l(t(i),null,{default:a(()=>e[11]||(e[11]=[n("Actions",-1)])),_:1,__:[11]})]),_:1})]),_:1}),l(t(R),null,{default:a(()=>[(f(!0),v(D,null,N(_.value,s=>(f(),F(t(g),{key:s.id,role:"button"},{default:a(()=>[l(t(d),null,{default:a(()=>[n(u(s.name),1)]),_:2},1024),l(t(d),null,{default:a(()=>[n(u(s.version),1)]),_:2},1024),l(t(d),null,{default:a(()=>[n(u(s.effectiveStart||"—"),1)]),_:2},1024),l(t(d),null,{default:a(()=>[n(u(s.effectiveEnd||"—"),1)]),_:2},1024),l(t(d),{role:"button",onClick:k=>b(s.id)},{default:a(()=>[n(u(s.payoutFrequency||"—"),1)]),_:2},1032,["onClick"]),l(t(d),null,{default:a(()=>[n(u(new Date(s.createdAt).toLocaleString()),1)]),_:2},1024),l(t(d),null,{default:a(()=>[l(t(C),{class:"btn btn-sm btn-outline-primary me-2",onClick:w(k=>b(s.id),["stop"])},{default:a(()=>e[12]||(e[12]=[n("Edit",-1)])),_:2,__:[12]},1032,["onClick"]),e[14]||(e[14]=n("  ",-1)),l(t(C),{color:"danger",size:"sm",onClick:w(k=>B(s.id),["stop"])},{default:a(()=>e[13]||(e[13]=[n("Delete",-1)])),_:2,__:[13]},1032,["onClick"])]),_:2,__:[14]},1024)]),_:2},1024))),128))]),_:1})]),_:1}),_.value.length===0?(f(),v("div",J," No "+u(r.value?"active":"archived")+" plans. ",1)):$("",!0)]))]),_:1})]),_:1})]))}};export{Z as default};
