import{r as i,o as I,c as f,d as n,a as s,b as l,u as t,h as v,C as y,e as o,R as F,l as b,t as u,f as j,F as P,g as $,i as N,k as r}from"./index-DPzvZzfM.js";import{C as E}from"./CAlert-HWKGY5e-.js";import{C as w}from"./CButton-CxoqXei-.js";import{C as p}from"./CCardHeader-CyVR9a-w.js";import{a as C,C as O}from"./CRow-VS3LaBfk.js";import{C as J,a as U,b as W,c as q,d as G}from"./CModalTitle-DUtptC4p.js";import{C as R}from"./CSpinner-4RQXIVOv.js";import{C as K,a as Q,b as S,c as L,d as X,e as c}from"./CTable-DK-5-MOF.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:"px-3 py-4"},h={key:0,class:"text-body-secondary d-flex align-items-center"},ee={key:2,class:"text-body-secondary"},te={class:"mt-2"},le={key:0,class:"text-body-secondary d-flex align-items-center"},se={key:2,class:"text-body-secondary"},ae={class:"mt-2"},oe={key:0,class:"py-3 d-flex align-items-center"},ne={key:2},de={class:"small"},re={class:"mb-0 error-pre"},ue={__name:"Settings",setup(ie){const z=i(null),A=i(null),_=i(!0),g=i("");async function V(m){const e=`/api/settings/${encodeURIComponent(m)}`,{data:a,status:d}=await N.get(e,{withCredentials:!0});return d===204||!a?null:a.setting_value??a.value??null}async function M(){var m,e;_.value=!0,g.value="";try{const[a,d]=await Promise.all([V("current_restore"),V("last_record_modification_date")]);z.value=a,A.value=d}catch(a){g.value=((e=(m=a==null?void 0:a.response)==null?void 0:m.data)==null?void 0:e.error)||(a==null?void 0:a.message)||"Failed to load settings."}finally{_.value=!1}}const x=i(!1),T=i(!1),k=i(""),B=i([]);async function D(m=10){var e,a;T.value=!0,k.value="";try{const{data:d}=await N.get("/api/error-logs",{params:{limit:m},withCredentials:!0});B.value=Array.isArray(d==null?void 0:d.data)?d.data:[]}catch(d){k.value=((a=(e=d==null?void 0:d.response)==null?void 0:e.data)==null?void 0:a.error)||(d==null?void 0:d.message)||"Failed to load error logs."}finally{T.value=!1}}function H(){x.value=!0,D(10)}return I(M),(m,e)=>(r(),f("div",Z,[e[26]||(e[26]=n("h1",{class:"h3 mb-4"},"Settings",-1)),s(t(O),{class:"g-4"},{default:l(()=>[s(t(C),{xs:"12",md:"6",mt:"3"},{default:l(()=>[s(t(v),null,{default:l(()=>[s(t(p),null,{default:l(()=>e[2]||(e[2]=[n("strong",null,"Error Logs",-1)])),_:1,__:[2]}),s(t(y),{class:"w-100"},{default:l(()=>[s(t(w),{color:"dark",size:"sm",onClick:H},{default:l(()=>e[3]||(e[3]=[o(" View Error Logs ",-1)])),_:1,__:[3]})]),_:1})]),_:1})]),_:1}),s(t(C),{xs:"12",md:"6"},{default:l(()=>[s(t(v),null,{default:l(()=>[s(t(p),null,{default:l(()=>e[4]||(e[4]=[n("strong",null,"Comp Plan Template",-1),n("div",{class:"small text-body-secondary"}," Edit the EJS compensation statement template. ",-1)])),_:1,__:[4]}),s(t(y),{class:"d-flex justify-content-between align-items-center"},{default:l(()=>[e[6]||(e[6]=n("div",{class:"text-body-secondary"}," Manage the template used to render comp statements. ",-1)),s(t(F),{class:"btn btn-secondary btn-sm",to:{name:"CompPlanTemplate"}},{default:l(()=>e[5]||(e[5]=[o(" Open ",-1)])),_:1,__:[5]})]),_:1,__:[6]})]),_:1})]),_:1}),s(t(C),{xs:"12",md:"6"},{default:l(()=>[s(t(v),null,{default:l(()=>[s(t(p),null,{default:l(()=>e[7]||(e[7]=[n("strong",null,"DB Admin",-1),n("div",{class:"small text-body-secondary"}," Backup and restore database content. ",-1)])),_:1,__:[7]}),s(t(y),{class:"d-flex justify-content-between align-items-center"},{default:l(()=>[e[9]||(e[9]=n("div",{class:"text-body-secondary"}," Access administrative tools for the database. ",-1)),s(t(F),{class:"btn btn-secondary btn-sm",to:{name:"Admin"}},{default:l(()=>e[8]||(e[8]=[o(" Open ",-1)])),_:1,__:[8]})]),_:1,__:[9]})]),_:1})]),_:1}),s(t(C),{xs:"12",md:"6",mt:"3"},{default:l(()=>[s(t(v),null,{default:l(()=>[s(t(p),null,{default:l(()=>e[10]||(e[10]=[n("strong",null,"Version",-1)])),_:1,__:[10]}),s(t(y),{class:"d-flex justify-content-between align-items-center"},{default:l(()=>e[11]||(e[11]=[n("div",{class:"text-body-secondary"}," VarCAC version 1.00.05 ",-1)])),_:1,__:[11]})]),_:1})]),_:1}),s(t(C),{xs:"12",md:"6",mt:"3"},{default:l(()=>[s(t(v),null,{default:l(()=>[s(t(p),null,{default:l(()=>e[12]||(e[12]=[n("strong",null,"Imported Working File",-1)])),_:1,__:[12]}),s(t(y),{class:"w-100"},{default:l(()=>[_.value?(r(),f("div",h,[s(t(R),{size:"sm",class:"me-2"}),e[13]||(e[13]=o(" Loading… ",-1))])):g.value?(r(),b(t(E),{key:1,color:"danger",class:"mb-0"},{default:l(()=>[o(u(g.value),1)]),_:1})):(r(),f("div",ee,u(z.value||"No restore recorded yet."),1)),n("div",te,[s(t(w),{size:"sm",color:"secondary",variant:"outline",disabled:_.value,onClick:M},{default:l(()=>e[14]||(e[14]=[o(" Refresh ",-1)])),_:1,__:[14]},8,["disabled"])])]),_:1})]),_:1})]),_:1}),s(t(C),{xs:"12",md:"6",mt:"3"},{default:l(()=>[s(t(v),null,{default:l(()=>[s(t(p),null,{default:l(()=>e[15]||(e[15]=[n("strong",null,"Last Record Modification Date",-1)])),_:1,__:[15]}),s(t(y),{class:"w-100"},{default:l(()=>[_.value?(r(),f("div",le,[s(t(R),{size:"sm",class:"me-2"}),e[16]||(e[16]=o(" Loading… ",-1))])):g.value?(r(),b(t(E),{key:1,color:"danger",class:"mb-0"},{default:l(()=>[o(u(g.value),1)]),_:1})):(r(),f("div",se,u(A.value||"—"),1)),n("div",ae,[s(t(w),{size:"sm",color:"secondary",variant:"outline",disabled:_.value,onClick:M},{default:l(()=>e[17]||(e[17]=[o(" Refresh ",-1)])),_:1,__:[17]},8,["disabled"])])]),_:1})]),_:1})]),_:1})]),_:1}),s(t(G),{visible:x.value,alignment:"center",backdrop:"static",size:"lg",onClose:e[1]||(e[1]=a=>x.value=!1)},{default:l(()=>[s(t(J),null,{default:l(()=>[s(t(U),null,{default:l(()=>e[18]||(e[18]=[o("Error Logs",-1)])),_:1,__:[18]})]),_:1}),s(t(W),null,{default:l(()=>[T.value?(r(),f("div",oe,[s(t(R),{size:"sm",class:"me-2"}),e[19]||(e[19]=o(" Loading… ",-1))])):k.value?(r(),b(t(E),{key:1,color:"danger",class:"mb-0"},{default:l(()=>[o(u(k.value),1)]),_:1})):(r(),f("div",ne,[s(t(K),{responsive:"",small:"",hover:"",bordered:"",class:"mb-0"},{default:l(()=>[s(t(Q),null,{default:l(()=>[s(t(S),null,{default:l(()=>[s(t(L),{scope:"col",style:{width:"80px"}},{default:l(()=>e[20]||(e[20]=[o("ID",-1)])),_:1,__:[20]}),s(t(L),{scope:"col",style:{width:"80px"}},{default:l(()=>e[21]||(e[21]=[o("Time",-1)])),_:1,__:[21]}),s(t(L),{scope:"col",style:{width:"240px"}},{default:l(()=>e[22]||(e[22]=[o("Error",-1)])),_:1,__:[22]}),s(t(L),{scope:"col"},{default:l(()=>e[23]||(e[23]=[o("Message",-1)])),_:1,__:[23]})]),_:1})]),_:1}),s(t(X),null,{default:l(()=>[B.value.length?j("",!0):(r(),b(t(S),{key:0},{default:l(()=>[s(t(c),{colspan:"3",class:"text-muted text-center py-3"},{default:l(()=>e[24]||(e[24]=[o(" No logs found. ",-1)])),_:1,__:[24]})]),_:1})),(r(!0),f(P,null,$(B.value,a=>(r(),b(t(S),{key:a.id},{default:l(()=>[s(t(c),null,{default:l(()=>[o(u(a.id),1)]),_:2},1024),s(t(c),null,{default:l(()=>[o(u(a.time_triggered),1)]),_:2},1024),s(t(c),null,{default:l(()=>[n("code",de,u(a.error_reference||"—"),1)]),_:2},1024),s(t(c),null,{default:l(()=>[n("pre",re,u(a.error_message||"—"),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]))]),_:1}),s(t(q),null,{default:l(()=>[s(t(w),{color:"dark",onClick:e[0]||(e[0]=a=>x.value=!1)},{default:l(()=>e[25]||(e[25]=[o("Close",-1)])),_:1,__:[25]})]),_:1})]),_:1},8,["visible"])]))}},ce=Y(ue,[["__scopeId","data-v-d73bef15"]]);export{ce as default};
