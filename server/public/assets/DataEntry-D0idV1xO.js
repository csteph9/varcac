import{r as p,o as c,c as d,a,w as n,u as l,e as i,C as k,l as x,b as f,p as r,F as b,f as I,n as F,g as B,h as v,i as L,j as s,t as u}from"./index-DY2iYVHx.js";import{C as R}from"./CButton-CBg_h1uZ.js";import{C as U}from"./CCardHeader-CxJUXy8l.js";import{C as E}from"./CForm-DPT3EXTc.js";import{C as y}from"./CFormInput-cfDnsWz9.js";import{C as w}from"./CFormSelect-CedCeGDc.js";import{C as M,a as m}from"./CRow-CoYbaDgy.js";const P={class:"p-3"},T=["value"],j=["value"],A={class:"d-flex gap-2 mt-4"},X={__name:"DataEntry",setup(H){const g=L(),_=p([]),C=p([]),o=p({participantId:"",elementDefinitionId:"",metricDate:"",value:""});c(async()=>{const[D,e]=await Promise.all([v.get("/api/participants",{withCredentials:!0}),v.get("/api/element-definitions",{withCredentials:!0})]);_.value=D.data||[],C.value=e.data||[]});const V=()=>o.value.participantId&&o.value.elementDefinitionId&&o.value.metricDate&&o.value.value!=="",N=async()=>{V()&&(await v.post("/api/metrics",{participantId:Number(o.value.participantId),elementDefinitionId:Number(o.value.elementDefinitionId),metricDate:o.value.metricDate,value:Number(o.value.value)},{withCredentials:!0}),alert("Value saved"),g.push({name:"DataList"}))};return(D,e)=>{const S=F("router-link");return s(),d("div",P,[a(l(B),null,{default:n(()=>[a(l(U),{class:"fw-semibold"},{default:n(()=>e[4]||(e[4]=[i("Add Value",-1)])),_:1,__:[4]}),a(l(k),null,{default:n(()=>[a(l(E),{onSubmit:x(N,["prevent"])},{default:n(()=>[a(l(M),{class:"g-3"},{default:n(()=>[a(l(m),{md:"6"},{default:n(()=>[a(l(r),null,{default:n(()=>e[5]||(e[5]=[i("Participant",-1)])),_:1,__:[5]}),a(l(w),{modelValue:o.value.participantId,"onUpdate:modelValue":e[0]||(e[0]=t=>o.value.participantId=t)},{default:n(()=>[e[6]||(e[6]=f("option",{value:"",disabled:""},"Select participant…",-1)),(s(!0),d(b,null,I(_.value,t=>(s(),d("option",{key:t.id,value:t.id},u(t.firstName)+" "+u(t.lastName)+" ("+u(t.employeeId)+") ",9,T))),128))]),_:1,__:[6]},8,["modelValue"])]),_:1}),a(l(m),{md:"6"},{default:n(()=>[a(l(r),null,{default:n(()=>e[7]||(e[7]=[i("Element",-1)])),_:1,__:[7]}),a(l(w),{modelValue:o.value.elementDefinitionId,"onUpdate:modelValue":e[1]||(e[1]=t=>o.value.elementDefinitionId=t)},{default:n(()=>[e[8]||(e[8]=f("option",{value:"",disabled:""},"Select element…",-1)),(s(!0),d(b,null,I(C.value,t=>(s(),d("option",{key:t.id,value:t.id},u(t.name)+" ("+u(t.elementType)+" · "+u(t.unit)+") ",9,j))),128))]),_:1,__:[8]},8,["modelValue"])]),_:1}),a(l(m),{md:"4"},{default:n(()=>[a(l(r),null,{default:n(()=>e[9]||(e[9]=[i("Date",-1)])),_:1,__:[9]}),a(l(y),{type:"date",modelValue:o.value.metricDate,"onUpdate:modelValue":e[2]||(e[2]=t=>o.value.metricDate=t)},null,8,["modelValue"])]),_:1}),a(l(m),{md:"4"},{default:n(()=>[a(l(r),null,{default:n(()=>e[10]||(e[10]=[i("Value",-1)])),_:1,__:[10]}),a(l(y),{modelValue:o.value.value,"onUpdate:modelValue":e[3]||(e[3]=t=>o.value.value=t),placeholder:"e.g. 3 or 2500.00"},null,8,["modelValue"])]),_:1})]),_:1}),f("div",A,[a(l(R),{type:"submit",color:"primary",disabled:!V()},{default:n(()=>e[11]||(e[11]=[i("Save",-1)])),_:1,__:[11]},8,["disabled"]),a(S,{class:"btn btn-secondary",to:{name:"DataList"}},{default:n(()=>e[12]||(e[12]=[i("Cancel",-1)])),_:1,__:[12]})])]),_:1})]),_:1})]),_:1})])}}};export{X as default};
