import{r as m,o as w,c as _,a as t,w as l,u as e,b as g,C as P,d as T,e as n,F as x,f as B,g as N,h as v,i as D,j as u,k as E,t as i,l as S}from"./index-DyVjuEV4.js";import{C as V}from"./CButton-Ob9G74z0.js";import{C as A}from"./CCardHeader-DbalRFEA.js";import{C as $}from"./CSpinner-Dn5wfHZO.js";import{C as F,a as H,b as y,c as r,d as L,e as d}from"./CTable-Dyd9aalW.js";const j={class:"p-3"},M={key:0,class:"py-3"},R={key:1},q={key:0,class:"text-muted"},Q={__name:"PlansList",setup(z){const b=D(),c=m(!0),f=m([]);w(async()=>{c.value=!0;try{const{data:o}=await v.get("/api/plans",{withCredentials:!0});f.value=o}finally{c.value=!1}});const C=o=>b.push({name:"PlanDetail",params:{id:o}}),k=async o=>{if(confirm("Delete this plan? All attached elements will be detached. This cannot be undone."))try{await v.delete(`/api/plans/${o}`,{withCredentials:!0}),f.value=f.value.filter(a=>a.id!==o)}catch(a){console.error(a),alert("Error deleting plan.")}};return(o,a)=>(u(),_("div",j,[t(e(N),null,{default:l(()=>[t(e(A),{class:"fw-semibold d-flex align-items-center justify-content-between"},{default:l(()=>a[0]||(a[0]=[g("span",null,"Plans",-1)])),_:1,__:[0]}),t(e(P),null,{default:l(()=>[c.value?(u(),_("div",M,[t(e($))])):(u(),_("div",R,[t(e(F),{hover:"",responsive:""},{default:l(()=>[t(e(H),null,{default:l(()=>[t(e(y),null,{default:l(()=>[t(e(r),{scope:"col"},{default:l(()=>a[1]||(a[1]=[n("Name",-1)])),_:1,__:[1]}),t(e(r),{scope:"col"},{default:l(()=>a[2]||(a[2]=[n("Version",-1)])),_:1,__:[2]}),t(e(r),{scope:"col"},{default:l(()=>a[3]||(a[3]=[n("Effective Start",-1)])),_:1,__:[3]}),t(e(r),{scope:"col"},{default:l(()=>a[4]||(a[4]=[n("Effective End",-1)])),_:1,__:[4]}),t(e(r),{scope:"col"},{default:l(()=>a[5]||(a[5]=[n("Payout",-1)])),_:1,__:[5]}),t(e(r),{scope:"col"},{default:l(()=>a[6]||(a[6]=[n("Created",-1)])),_:1,__:[6]}),t(e(r),{scope:"col"},{default:l(()=>a[7]||(a[7]=[n("Actions",-1)])),_:1,__:[7]})]),_:1})]),_:1}),t(e(L),null,{default:l(()=>[(u(!0),_(x,null,B(f.value,s=>(u(),E(e(y),{key:s.id,role:"button",onClick:p=>C(s.id)},{default:l(()=>[t(e(d),null,{default:l(()=>[n(i(s.name),1)]),_:2},1024),t(e(d),null,{default:l(()=>[n(i(s.version),1)]),_:2},1024),t(e(d),null,{default:l(()=>[n(i(s.effectiveStart||"—"),1)]),_:2},1024),t(e(d),null,{default:l(()=>[n(i(s.effectiveEnd||"—"),1)]),_:2},1024),t(e(d),{role:"button",onClick:p=>C(s.id)},{default:l(()=>[n(i(s.payoutFrequency||"—"),1)]),_:2},1032,["onClick"]),t(e(d),null,{default:l(()=>[n(i(new Date(s.createdAt).toLocaleString()),1)]),_:2},1024),t(e(d),null,{default:l(()=>[t(e(V),{color:"danger",size:"sm",onClick:S(p=>k(s.id),["stop"])},{default:l(()=>a[8]||(a[8]=[n("Delete",-1)])),_:2,__:[8]},1032,["onClick"])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),f.value.length===0?(u(),_("div",q,"No plans yet. Create one in “Add New Plan”.")):T("",!0)]))]),_:1})]),_:1})]))}};export{Q as default};
