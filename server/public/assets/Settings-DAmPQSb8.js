import{r as i,o as I,c as f,d as n,a as s,b as l,u as t,h as _,C as g,R as S,e as o,l as b,t as u,f as j,F as O,g as P,i as H,k as r}from"./index-CFGD_Gi7.js";import{C as E}from"./CAlert-DAczoeYR.js";import{C as w}from"./CButton-Bar-IVn5.js";import{C as y}from"./CCardHeader-j1dVyNP9.js";import{a as v,C as $}from"./CRow-CQIQrd1B.js";import{C as J,a as K,b as U,c as W,d as q}from"./CModalTitle-BJzK3tic.js";import{C as R}from"./CSpinner-B_QOP7IZ.js";import{C as G,a as Q,b as z,c as L,d as X,e as x}from"./CTable-D8-Qdao0.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:"px-3 py-4"},h={key:0,class:"text-body-secondary d-flex align-items-center"},ee={key:2,class:"text-body-secondary"},te={class:"mt-2"},le={key:0,class:"text-body-secondary d-flex align-items-center"},se={key:2,class:"text-body-secondary"},ae={class:"mt-2"},oe={key:0,class:"py-3 d-flex align-items-center"},ne={key:2},de={class:"small"},re={class:"mb-0 error-pre"},ue={__name:"Settings",setup(ie){const A=i(null),V=i(null),p=i(!0),C=i("");async function F(m){const e=`/api/settings/${encodeURIComponent(m)}`,{data:a,status:d}=await H.get(e,{withCredentials:!0});return console.log(a),d===204||!a?null:a.setting_value??a.value??null}async function M(){var m,e;p.value=!0,C.value="";try{const[a,d,fe]=await Promise.all([F("current_restore"),F("last_record_modification_date")]);A.value=a,V.value=d}catch(a){C.value=((e=(m=a==null?void 0:a.response)==null?void 0:m.data)==null?void 0:e.error)||(a==null?void 0:a.message)||"Failed to load settings."}finally{p.value=!1}}const c=i(!1),T=i(!1),k=i(""),B=i([]);async function N(m=10){var e,a;T.value=!0,k.value="";try{const{data:d}=await H.get("/api/error-logs",{params:{limit:m},withCredentials:!0});B.value=Array.isArray(d==null?void 0:d.data)?d.data:[]}catch(d){k.value=((a=(e=d==null?void 0:d.response)==null?void 0:e.data)==null?void 0:a.error)||(d==null?void 0:d.message)||"Failed to load error logs."}finally{T.value=!1}}function D(){c.value=!0,N(10)}return I(M),(m,e)=>(r(),f("div",Z,[e[28]||(e[28]=n("h1",{class:"h3 mb-4"},"Settings",-1)),s(t($),{class:"g-4"},{default:l(()=>[s(t(v),{xs:"12",md:"6",mt:"3"},{default:l(()=>[s(t(_),null,{default:l(()=>[s(t(y),null,{default:l(()=>e[2]||(e[2]=[n("strong",null,"Statement Hub Config",-1)])),_:1,__:[2]}),s(t(g),{class:"w-100"},{default:l(()=>[s(t(S),{class:"btn btn-secondary btn-sm",to:{name:"StatementHubConfig"}},{default:l(()=>e[3]||(e[3]=[o(" Open ",-1)])),_:1,__:[3]})]),_:1})]),_:1})]),_:1}),s(t(v),{xs:"12",md:"6",mt:"3"},{default:l(()=>[s(t(_),null,{default:l(()=>[s(t(y),null,{default:l(()=>e[4]||(e[4]=[n("strong",null,"Error Logs",-1)])),_:1,__:[4]}),s(t(g),{class:"w-100"},{default:l(()=>[s(t(w),{color:"dark",size:"sm",onClick:D},{default:l(()=>e[5]||(e[5]=[o(" View Error Logs ",-1)])),_:1,__:[5]})]),_:1})]),_:1})]),_:1}),s(t(v),{xs:"12",md:"6"},{default:l(()=>[s(t(_),null,{default:l(()=>[s(t(y),null,{default:l(()=>e[6]||(e[6]=[n("strong",null,"Comp Plan Template",-1),n("div",{class:"small text-body-secondary"}," Edit the EJS compensation statement template. ",-1)])),_:1,__:[6]}),s(t(g),{class:"d-flex justify-content-between align-items-center"},{default:l(()=>[e[8]||(e[8]=n("div",{class:"text-body-secondary"}," Manage the template used to render comp statements. ",-1)),s(t(S),{class:"btn btn-secondary btn-sm",to:{name:"CompPlanTemplate"}},{default:l(()=>e[7]||(e[7]=[o(" Open ",-1)])),_:1,__:[7]})]),_:1,__:[8]})]),_:1})]),_:1}),s(t(v),{xs:"12",md:"6"},{default:l(()=>[s(t(_),null,{default:l(()=>[s(t(y),null,{default:l(()=>e[9]||(e[9]=[n("strong",null,"DB Admin",-1),n("div",{class:"small text-body-secondary"}," Backup and restore database content. ",-1)])),_:1,__:[9]}),s(t(g),{class:"d-flex justify-content-between align-items-center"},{default:l(()=>[e[11]||(e[11]=n("div",{class:"text-body-secondary"}," Access administrative tools for the database. ",-1)),s(t(S),{class:"btn btn-secondary btn-sm",to:{name:"Admin"}},{default:l(()=>e[10]||(e[10]=[o(" Open ",-1)])),_:1,__:[10]})]),_:1,__:[11]})]),_:1})]),_:1}),s(t(v),{xs:"12",md:"6",mt:"3"},{default:l(()=>[s(t(_),null,{default:l(()=>[s(t(y),null,{default:l(()=>e[12]||(e[12]=[n("strong",null,"Version",-1)])),_:1,__:[12]}),s(t(g),{class:"d-flex justify-content-between align-items-center"},{default:l(()=>e[13]||(e[13]=[n("div",{class:"text-body-secondary"},"VarCAC version 1.00.05",-1)])),_:1,__:[13]})]),_:1})]),_:1}),s(t(v),{xs:"12",md:"6",mt:"3"},{default:l(()=>[s(t(_),null,{default:l(()=>[s(t(y),null,{default:l(()=>e[14]||(e[14]=[n("strong",null,"Imported Working File",-1)])),_:1,__:[14]}),s(t(g),{class:"w-100"},{default:l(()=>[p.value?(r(),f("div",h,[s(t(R),{size:"sm",class:"me-2"}),e[15]||(e[15]=o(" Loading… ",-1))])):C.value?(r(),b(t(E),{key:1,color:"danger",class:"mb-0"},{default:l(()=>[o(u(C.value),1)]),_:1})):(r(),f("div",ee,u(A.value||"No restore recorded yet."),1)),n("div",te,[s(t(w),{size:"sm",color:"secondary",variant:"outline",disabled:p.value,onClick:M},{default:l(()=>e[16]||(e[16]=[o(" Refresh ",-1)])),_:1,__:[16]},8,["disabled"])])]),_:1})]),_:1})]),_:1}),s(t(v),{xs:"12",md:"6",mt:"3"},{default:l(()=>[s(t(_),null,{default:l(()=>[s(t(y),null,{default:l(()=>e[17]||(e[17]=[n("strong",null,"Last Record Modification Date",-1)])),_:1,__:[17]}),s(t(g),{class:"w-100"},{default:l(()=>[p.value?(r(),f("div",le,[s(t(R),{size:"sm",class:"me-2"}),e[18]||(e[18]=o(" Loading… ",-1))])):C.value?(r(),b(t(E),{key:1,color:"danger",class:"mb-0"},{default:l(()=>[o(u(C.value),1)]),_:1})):(r(),f("div",se,u(V.value||"—"),1)),n("div",ae,[s(t(w),{size:"sm",color:"secondary",variant:"outline",disabled:p.value,onClick:M},{default:l(()=>e[19]||(e[19]=[o(" Refresh ",-1)])),_:1,__:[19]},8,["disabled"])])]),_:1})]),_:1})]),_:1})]),_:1}),s(t(q),{visible:c.value,alignment:"center",backdrop:"static",size:"xl",onClose:e[1]||(e[1]=a=>c.value=!1)},{default:l(()=>[s(t(J),null,{default:l(()=>[s(t(K),null,{default:l(()=>e[20]||(e[20]=[o("Error Logs",-1)])),_:1,__:[20]})]),_:1}),s(t(U),null,{default:l(()=>[T.value?(r(),f("div",oe,[s(t(R),{size:"sm",class:"me-2"}),e[21]||(e[21]=o(" Loading… ",-1))])):k.value?(r(),b(t(E),{key:1,color:"danger",class:"mb-0"},{default:l(()=>[o(u(k.value),1)]),_:1})):(r(),f("div",ne,[s(t(G),{responsive:"",small:"",hover:"",bordered:"",class:"mb-0"},{default:l(()=>[s(t(Q),null,{default:l(()=>[s(t(z),null,{default:l(()=>[s(t(L),{style:{width:"80px"}},{default:l(()=>e[22]||(e[22]=[o("ID",-1)])),_:1,__:[22]}),s(t(L),{style:{width:"80px"}},{default:l(()=>e[23]||(e[23]=[o("Time",-1)])),_:1,__:[23]}),s(t(L),{style:{width:"240px"}},{default:l(()=>e[24]||(e[24]=[o("Error",-1)])),_:1,__:[24]}),s(t(L),null,{default:l(()=>e[25]||(e[25]=[o("Message",-1)])),_:1,__:[25]})]),_:1})]),_:1}),s(t(X),null,{default:l(()=>[B.value.length?j("",!0):(r(),b(t(z),{key:0},{default:l(()=>[s(t(x),{colspan:"3",class:"text-muted text-center py-3"},{default:l(()=>e[26]||(e[26]=[o(" No logs found. ",-1)])),_:1,__:[26]})]),_:1})),(r(!0),f(O,null,P(B.value,a=>(r(),b(t(z),{key:a.id},{default:l(()=>[s(t(x),null,{default:l(()=>[o(u(a.id),1)]),_:2},1024),s(t(x),null,{default:l(()=>[o(u(a.time_triggered),1)]),_:2},1024),s(t(x),null,{default:l(()=>[n("code",de,u(a.error_reference||"—"),1)]),_:2},1024),s(t(x),null,{default:l(()=>[n("pre",re,u(a.error_message||"—"),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]))]),_:1}),s(t(W),null,{default:l(()=>[s(t(w),{color:"dark",onClick:e[0]||(e[0]=a=>c.value=!1)},{default:l(()=>e[27]||(e[27]=[o("Close",-1)])),_:1,__:[27]})]),_:1})]),_:1},8,["visible"])]))}},ce=Y(ue,[["__scopeId","data-v-f35f2564"]]);export{ce as default};
