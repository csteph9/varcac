import{r as c,n as L,o as He,w as Ie,c as u,a as l,u as t,b as a,d as v,e as i,t as p,R as je,v as qe,C as te,h as le,F as k,g as I,f as B,s as ve,l as H,i as S,j as Ze,q as Pe,k as d,m as Ge}from"./index-CFGD_Gi7.js";import{C as Je}from"./CBadge-41XLtnlL.js";import{C as _}from"./CButton-Bar-IVn5.js";import{C as Ke}from"./CButtonGroup-BmNVzGeG.js";import{C as ae}from"./CCardHeader-j1dVyNP9.js";import{C as Ye}from"./CForm-8Di4je1x.js";import{C as $e}from"./CFormInput-vGO62AtJ.js";import{C as fe}from"./CFormSelect-BXUyUJls.js";import{C as Qe,a as ye}from"./CRow-CQIQrd1B.js";import{C as se,a as ne,b as oe,c as ie,d as re}from"./CModalTitle-BJzK3tic.js";import{C as h}from"./CSpinner-B_QOP7IZ.js";import{C as Le,a as he,b as de,c as j,d as De,e as P}from"./CTable-D8-Qdao0.js";var We=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M479.6,399.716l-81.084-81.084-62.368-25.767A175.014,175.014,0,0,0,368,192c0-97.047-78.953-176-176-176S16,94.953,16,192,94.953,368,192,368a175.034,175.034,0,0,0,101.619-32.377l25.7,62.2L400.4,478.911a56,56,0,1,0,79.2-79.195ZM48,192c0-79.4,64.6-144,144-144s144,64.6,144,144S271.4,336,192,336,48,271.4,48,192ZM456.971,456.284a24.028,24.028,0,0,1-33.942,0l-76.572-76.572-23.894-57.835L380.4,345.771l76.573,76.572A24.028,24.028,0,0,1,456.971,456.284Z' class='ci-primary'/>"];const Xe={class:"p-3"},et={key:0,class:"py-3"},tt={key:1},lt={key:2},at={class:"text-muted small"},st={class:"d-flex gap-2"},nt={key:0},ot={key:0,class:"text-muted"},it={key:1},rt={class:"d-flex flex-wrap"},dt={key:1,class:"text-muted"},ut={key:0},pt={key:1},mt={key:0,class:"text-muted"},ct={class:"d-flex align-items-center mb-2"},vt={class:"me-2"},ft={key:0,class:"text-muted"},yt={class:"mb-0 ps-3"},bt={class:"me-2"},_t={class:"text-muted ms-2"},gt={class:"mb-0 ps-0",style:{"list-style":"none"}},wt=["onClick"],Ct={key:0,class:"text-muted"},kt={key:1,class:"d-flex flex-column gap-2"},St=["value","disabled"],At=["value"],xt={key:0,class:"text-muted"},It={key:1,class:"text-danger"},jt={key:2,class:"text-muted"},Pt={class:"mb-3"},$t=["value"],Lt={key:0,class:"text-danger mt-2"},ht={key:0,class:"d-flex align-items-center text-body-secondary"},Dt={key:2,class:"preview-wrap"},Nt=["srcdoc"],Tt={key:1,class:"mb-0 small"},Jt={__name:"ParticipantDetail",setup(Mt){const w=qe(),be=Ze(),ue=c(!0),A=c({participant:null,plans:[]}),D=c(""),g=c(!0),E=c(!1),_e=c([]),F=c(""),N=c({loading:!0,plans:[]}),T=c({loading:!0,allInputs:[],plans:[]});c(!1),c(""),c("");const q=c(!1),Z=c(!1),G=c(""),z=c(!1),$=c(!1),M=c(new Set),ge=L({get:()=>[...M.value],set:r=>{M.value=new Set(r.map(Number).filter(e=>Number.isFinite(e)))}}),Ne=L(()=>Math.min(10,Math.max(4,Y.value.length))),U=c(["ACTUAL"]),x=c([]),J=c(!0),K=c(""),we=r=>{const e=Number(r??0);return Number.isFinite(e)?e.toLocaleString(void 0,{style:"currency",currency:"USD",maximumFractionDigits:2}):"—"},Ce=L(()=>{var e;return(((e=A.value)==null?void 0:e.plans)||[]).map(o=>{var n,f,y;const m=o.planId??o.plan_id??((n=o.plan)==null?void 0:n.id)??o.cpId??o.cid??null,s=Number(o.isActive??o.is_active??((f=o.plan)==null?void 0:f.isActive)??((y=o.plan)==null?void 0:y.is_active)??1);return{...o,planId:m,isActive:s}}).filter(o=>o.planId)}),Te=L(()=>{const r=new Map;for(const e of Ce.value)r.set(Number(e.planId),Number(e.isActive));return r}),pe=L(()=>{const r=g.value?1:0,e=(D.value||"").toLowerCase().trim(),o=Ce.value.filter(m=>Number(m.isActive)===r);return e?o.filter(m=>String(m.name||"").toLowerCase().includes(e)||String(m.version||"").toLowerCase().includes(e)):o}),Y=L(()=>pe.value),R=async()=>{var r,e,o;ue.value=!0;try{const{data:m}=await S.get(`/api/participants/${w.params.id}`,{withCredentials:!0,params:{isActive:g.value?1:0}}),s=Array.isArray(m.plans)?m.plans:[];for(const n of s)n.planId=n.planId??n.plan_id??((r=n.plan)==null?void 0:r.id)??n.cpId??n.cid??null,n.isActive=Number(n.isActive??n.is_active??((e=n.plan)==null?void 0:e.isActive)??((o=n.plan)==null?void 0:o.is_active)??1);A.value={participant:m.participant??null,plans:s}}finally{ue.value=!1}},Me=async()=>{const{data:r}=await S.get("/api/plans?isActive=1",{withCredentials:!0});_e.value=r||[]},O=async()=>{N.value.loading=!0;try{const{data:r}=await S.get(`/api/participants/${w.params.id}/payout-history`,{withCredentials:!0,params:{isActive:g.value?1:0}});N.value.plans=(r==null?void 0:r.plans)||[]}finally{N.value.loading=!1}},Q=async()=>{T.value.loading=!0;try{const{data:r}=await S.get(`/api/participants/${w.params.id}/required-source-inputs`,{withCredentials:!0});T.value={loading:!1,allInputs:Array.isArray(r==null?void 0:r.allInputs)?r.allInputs:[],plans:Array.isArray(r==null?void 0:r.plans)?r.plans:[]}}catch(r){console.error(r),T.value={loading:!1,allInputs:[],plans:[]}}};async function ke(){var r,e;K.value="",J.value=!0,x.value=[];try{let m=new Set,s=0;const n=500;let f=1/0;for(;s<f&&s<5e3;){const{data:y}=await S.get("/api/source-data",{withCredentials:!0,params:{participantId:w.params.id,limit:n,offset:s}}),b=y||{},C=Array.isArray(b)?b:b.records||[];f=Number(b.total??C.length??0)||0;for(const ee of C){const xe=(ee.recordScope??ee.record_scope??"").toString().trim();xe&&m.add(xe)}if(s+=n,!C.length)break}x.value=Array.from(m).sort(),x.value.length||(x.value=["ACTUAL"])}catch(o){console.error(o),K.value=((e=(r=o==null?void 0:o.response)==null?void 0:r.data)==null?void 0:e.error)||"Failed to load record scopes",x.value.length||(x.value=["ACTUAL"])}finally{J.value=!1;const o=new Set((U.value||[]).map(m=>String(m||"").trim()).filter(Boolean));if(o.size){const m=new Set([...x.value,...o]);x.value=Array.from(m).sort()}}}He(async()=>{await Promise.all([R(),Me(),O(),Q(),ke()])}),Ie(()=>w.params.id,async()=>{await Promise.all([R(),O(),Q(),ke()])}),Ie(g,async()=>{M.value=new Set,D.value="",await Promise.all([R(),O()])});const Ve=r=>be.push({name:"PlanDetail",params:{id:r}}),Ee=async()=>{F.value&&(await S.post(`/api/participants/${w.params.id}/plans`,{planId:Number(F.value)},{withCredentials:!0}),E.value=!1,await Promise.all([R(),O(),Q()]))},Fe=async r=>{confirm("Detach this plan from the participant? All historical calculations will be removed.")&&(await S.delete(`/api/participants/${w.params.id}/plans/${r}`,{withCredentials:!0}),await Promise.all([R(),O(),Q()]))},ze=()=>{G.value="",q.value=!0},Ue=async()=>{var r,e;Z.value=!0;try{await S.delete(`/api/participants/${w.params.id}`,{withCredentials:!0}),be.push({name:"ParticipantsList"})}catch(o){console.error(o),G.value=((e=(r=o==null?void 0:o.response)==null?void 0:r.data)==null?void 0:e.error)||"Failed to delete"}finally{Z.value=!1}},Re=async()=>{var m,s;if(!M.value.size)return;const r=Array.from(M.value),e=Array.isArray(U.value)?U.value.map(n=>String(n||"").trim()).filter(Boolean):[],o=e.length?e:["ACTUAL"];$.value=!0;try{const{data:n}=await S.post(`/api/participants/${w.params.id}/comp-statement`,{planIds:r,recordScopes:o},{withCredentials:!0,responseType:"blob"}),f=new Blob([n],{type:"text/html"}),y=URL.createObjectURL(f),b=document.createElement("a"),C=new Date,ee=`${C.getFullYear()}-${String(C.getMonth()+1).padStart(2,"0")}-${String(C.getDate()).padStart(2,"0")}`;b.href=y,b.download=`CompStatement_${((s=(m=A.value)==null?void 0:m.participant)==null?void 0:s.lastName)??"Participant"}_${ee}.html`,document.body.appendChild(b),b.click(),b.remove(),URL.revokeObjectURL(y),z.value=!1}catch(n){console.error(n),alert("Failed to generate statement")}finally{$.value=!1}},Se=L(()=>{var o;const r=g.value?1:0;return(Array.isArray((o=N.value)==null?void 0:o.plans)?N.value.plans:[]).filter(m=>{const s=m.isActive??m.is_active;return(s!=null?Number(s):Te.value.get(Number(m.planId))??null)===r})}),me=c(!1),ce=c(!1),W=c(""),V=c(""),X=c("");async function Oe(r,e,o){var m,s;me.value=!0,ce.value=!0,W.value="",V.value="",X.value="";try{let n;if(o!=null&&o.id){const{data:b}=await S.get(`/api/payout-history/${o.id}/payload`,{withCredentials:!0});n=b==null?void 0:b.payload}else{const b=(rowOrPlanId==null?void 0:rowOrPlanId.planId)??rowOrPlanId,{data:C}=await S.get("/api/payout-history/resolve",{withCredentials:!0,params:{participantId:w.params.id,planId:b,periodStart:e.periodStart,periodEnd:e.periodEnd,outputLabel:o.outputLabel,createdAt:o.createdAt}});n=C==null?void 0:C.payload}if(!n)throw new Error("No payload returned");const f=typeof n=="string"?n:JSON.stringify(n);if(/^\s*<(?:!DOCTYPE|html|body|div|span)/i.test(f)||/<body[^>]*>/i.test(f)){V.value=f;return}try{const b=typeof n=="string"?JSON.parse(n):n;V.value=Be(b)}catch{X.value=typeof n=="string"?n:String(n)}}catch(n){W.value=((s=(m=n==null?void 0:n.response)==null?void 0:m.data)==null?void 0:s.error)||(n==null?void 0:n.message)||"Failed to fetch payload."}finally{ce.value=!1}}function Be(r){function e(o){return o==null?'<span class="jt-null">—</span>':typeof o=="number"||typeof o=="boolean"?`<span class="jt-primitive">${String(o)}</span>`:typeof o=="string"?`<span class="jt-string">${o.replace(/[&<>]/g,y=>({"&":"&amp;","<":"&lt;",">":"&gt;"})[y]).replace(/\bhttps?:\/\/[^\s<]+/g,y=>`<a href="${y}" target="_blank" rel="noopener noreferrer">${y}</a>`)}</span>`:Array.isArray(o)?`<table class="jt jt-array"><tbody>${o.map((f,y)=>`<tr><th class="jt-index">${y}</th><td>${e(f)}</td></tr>`).join("")||'<tr><td class="jt-empty">[empty]</td></tr>'}</tbody></table>`:`<table class="jt jt-object"><tbody>${Object.keys(o).map(n=>`<tr><th>${n.replace(/[&<>]/g,y=>({"&":"&amp;","<":"&lt;",">":"&gt;"})[y])}</th><td>${e(o[n])}</td></tr>`).join("")||'<tr><td class="jt-empty">{empty}</td></tr>'}</tbody></table>`}return`<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title>Preview</title>
<style>
  :root { --jt-border:#e5e7eb; --jt-bg:#fafafa; --jt-key:#6b7280; --jt-index:#9ca3af; --jt-code:#111827; }
  body { margin: 0; padding: 16px; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji"; color:#111827; }
  .jt { border-collapse: collapse; width: 100%; margin: 6px 0; table-layout: fixed; }
  .jt th, .jt td { border: 1px solid var(--jt-border); padding: 8px 10px; vertical-align: top; word-wrap: break-word; }
  .jt th { background: var(--jt-bg); color: var(--jt-key); text-align: left; white-space: nowrap; }
  .jt-array .jt-index { color: var(--jt-index); width: 60px; }
  .jt-empty { color: var(--jt-index); font-style: italic; }
  .jt-string, .jt-primitive { color: var(--jt-code); }
  a { color: #2563eb; text-decoration: none; }
  a:hover { text-decoration: underline; }
  .jt td > .jt { margin: 0; width: 100%; }
  html, body { height: 100%; width: 100%; }
</style>
</head>
<body>
${e(r)}
</body>
</html>`}function Ae(){me.value=!1,V.value="",X.value=""}return(r,e)=>{const o=Pe("CIcon"),m=Pe("CAlert");return d(),u("div",Xe,[ue.value?(d(),u("div",et,[l(t(h))])):A.value.participant?(d(),u("div",lt,[l(t(le),{class:"mb-3"},{default:a(()=>[l(t(ae),{class:"fw-semibold d-flex align-items-center justify-content-between"},{default:a(()=>[v("span",null,[i(" Participant: "+p(A.value.participant.firstName)+" "+p(A.value.participant.lastName)+" ",1),v("span",at,"(#"+p(A.value.participant.id)+")",1)]),v("div",st,[l(t(je),{class:"btn btn-outline-primary me-2",to:{name:"ParticipantEdit",params:{id:t(w).params.id}}},{default:a(()=>e[15]||(e[15]=[i("Edit",-1)])),_:1,__:[15]},8,["to"]),l(t(_),{color:"danger",variant:"outline",onClick:ze},{default:a(()=>e[16]||(e[16]=[i("Delete",-1)])),_:1,__:[16]}),l(t(_),{color:"primary",size:"sm",onClick:e[0]||(e[0]=s=>E.value=!0)},{default:a(()=>e[17]||(e[17]=[i("Attach Plan",-1)])),_:1,__:[17]}),l(t(_),{color:"warning",size:"sm",onClick:e[1]||(e[1]=s=>z.value=!0)},{default:a(()=>e[18]||(e[18]=[i("Comp Statement",-1)])),_:1,__:[18]})])]),_:1}),l(t(te),null,{default:a(()=>[l(t(Qe),null,{default:a(()=>[l(t(ye),{md:"4"},{default:a(()=>[e[19]||(e[19]=v("strong",null,"Email:",-1)),i(" "+p(A.value.participant.email),1)]),_:1,__:[19]}),l(t(ye),{md:"4"},{default:a(()=>[e[20]||(e[20]=v("strong",null,"ID:",-1)),i(" "+p(A.value.participant.id),1)]),_:1,__:[20]}),l(t(ye),{md:"4"},{default:a(()=>[e[21]||(e[21]=v("strong",null,"Created:",-1)),i(" "+p(new Date(A.value.participant.createdAt).toLocaleString()),1)]),_:1,__:[21]})]),_:1})]),_:1})]),_:1}),l(t(le),{class:"mb-3"},{default:a(()=>[l(t(ae),{class:"fw-semibold"},{default:a(()=>e[22]||(e[22]=[i("Required Source Data Inputs",-1)])),_:1,__:[22]}),l(t(te),null,{default:a(()=>[T.value.loading?(d(),u("div",nt,[l(t(h))])):(d(),u(k,{key:1},[T.value.allInputs.length?(d(),u("div",it,[e[23]||(e[23]=v("h6",{class:"mb-2"},"All required data source labels for this participant, based on their attached plans & computations.",-1)),v("div",rt,[(d(!0),u(k,null,I(T.value.allInputs,s=>(d(),u("span",{key:"all-"+s,class:"badge rounded-pill text-bg-secondary me-2 mb-2"},p(s),1))),128))])])):(d(),u("div",ot," No source data requirements detected for this participant’s attached plans. "))],64))]),_:1})]),_:1}),l(t(le),null,{default:a(()=>[l(t(ae),{class:"fw-semibold d-flex align-items-center justify-content-between"},{default:a(()=>[e[26]||(e[26]=v("span",null,"Attached Plans",-1)),l(t(Ke),{size:"sm"},{default:a(()=>[l(t(_),{color:g.value?"primary":"secondary",onClick:e[2]||(e[2]=s=>g.value=!0)},{default:a(()=>e[24]||(e[24]=[i("Active",-1)])),_:1,__:[24]},8,["color"]),l(t(_),{color:g.value?"secondary":"primary",onClick:e[3]||(e[3]=s=>g.value=!1)},{default:a(()=>e[25]||(e[25]=[i("Archived",-1)])),_:1,__:[25]},8,["color"])]),_:1})]),_:1,__:[26]}),l(t(te),null,{default:a(()=>[pe.value.length?(d(),u(k,{key:0},[l(t($e),{modelValue:D.value,"onUpdate:modelValue":e[4]||(e[4]=s=>D.value=s),placeholder:"Filter plans…",class:"mb-3"},null,8,["modelValue"]),l(t(Le),{hover:"",responsive:""},{default:a(()=>[l(t(he),null,{default:a(()=>[l(t(de),null,{default:a(()=>[l(t(j),null,{default:a(()=>e[27]||(e[27]=[i("Name",-1)])),_:1,__:[27]}),l(t(j),null,{default:a(()=>e[28]||(e[28]=[i("Plan Effective",-1)])),_:1,__:[28]}),l(t(j),null,{default:a(()=>e[29]||(e[29]=[i("Attached",-1)])),_:1,__:[29]}),l(t(j),null,{default:a(()=>e[30]||(e[30]=[i("Actions",-1)])),_:1,__:[30]})]),_:1})]),_:1}),l(t(De),null,{default:a(()=>[(d(!0),u(k,null,I(pe.value,s=>(d(),H(t(de),{key:s.planId},{default:a(()=>[l(t(P),null,{default:a(()=>[l(t(_),{class:"btn btn-sm btn-outline-primary me-2",onClick:Ge(n=>Ve(s.planId),["stop"])},{default:a(()=>[i(p(s.name),1)]),_:2},1032,["onClick"]),e[31]||(e[31]=i(" ",-1))]),_:2,__:[31]},1024),l(t(P),null,{default:a(()=>[i(p(new Date(s.planEffectiveStart).toISOString().split("T")[0]||"—")+" → "+p(new Date(s.planEffectiveEnd).toISOString().split("T")[0]||"—"),1)]),_:2},1024),l(t(P),null,{default:a(()=>[i(p(new Date(s.attachedAt).toLocaleString()),1)]),_:2},1024),l(t(P),null,{default:a(()=>[l(t(_),{color:"secondary",size:"sm",onClick:n=>Fe(s.planId)},{default:a(()=>e[32]||(e[32]=[i("Detach",-1)])),_:2,__:[32]},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})],64)):(d(),u("div",dt,"No "+p(g.value?"active":"archived")+" plans attached.",1))]),_:1})]),_:1}),l(t(le),{class:"mt-3"},{default:a(()=>[l(t(ae),{class:"fw-semibold d-flex justify-content-between align-items-center"},{default:a(()=>[e[34]||(e[34]=v("span",null,"Payout History (by Plan & Period)",-1)),l(t(je),{class:"btn btn-sm btn-outline-primary",to:{name:"PlansList"}},{default:a(()=>e[33]||(e[33]=[i("View Plans",-1)])),_:1,__:[33]})]),_:1,__:[34]}),l(t(te),null,{default:a(()=>[N.value.loading?(d(),u("div",ut,[l(t(h))])):(d(),u("div",pt,[Se.value.length?B("",!0):(d(),u("div",mt," No payout history for "+p(g.value?"active":"archived")+" plans. ",1)),(d(!0),u(k,null,I(Se.value,s=>(d(),u("div",{key:s.planId,class:"mb-4"},[v("div",ct,[v("strong",vt,p(s.planName),1),l(t(Je),{color:"secondary",class:"me-2"},{default:a(()=>[i("v"+p(s.planVersion),1)]),_:2},1024)]),l(t(Le),{hover:"",responsive:"",small:""},{default:a(()=>[l(t(he),null,{default:a(()=>[l(t(de),null,{default:a(()=>[l(t(j),{style:{"min-width":"120px"}},{default:a(()=>e[35]||(e[35]=[i("Period",-1)])),_:1,__:[35]}),l(t(j),{style:{"min-width":"120px"}},{default:a(()=>e[36]||(e[36]=[i("Period End Date",-1)])),_:1,__:[36]}),l(t(j),{style:{"min-width":"160px","text-align":"center"}},{default:a(()=>e[37]||(e[37]=[i("Total Payout",-1)])),_:1,__:[37]}),l(t(j),null,{default:a(()=>e[38]||(e[38]=[i("Computations",-1)])),_:1,__:[38]}),l(t(j),{style:{width:"120px","text-align":"center"}},{default:a(()=>e[39]||(e[39]=[i("View Detail",-1)])),_:1,__:[39]})]),_:1})]),_:1}),l(t(De),null,{default:a(()=>[(d(!0),u(k,null,I(s.periods,n=>(d(),H(t(de),{key:n.periodStart+"|"+n.periodEnd+"|"+(n.periodLabel||"")},{default:a(()=>[l(t(P),null,{default:a(()=>[v("div",null,[i(p(new Date(n.periodStart).toISOString().split("T")[0])+" ⭾ ",1),e[40]||(e[40]=v("br",null,null,-1)),i(" "+p(new Date(n.periodEnd).toISOString().split("T")[0]),1)])]),_:2},1024),l(t(P),null,{default:a(()=>[i(p(new Date(n.dueDate).toISOString().split("T")[0]),1),e[41]||(e[41]=v("br",null,null,-1)),n.periodLabel?(d(),u("small",ft,p(n.periodLabel),1)):B("",!0)]),_:2,__:[41]},1024),l(t(P),{style:{"text-align":"center"}},{default:a(()=>[v("strong",null,p(we(n.total)),1)]),_:2},1024),l(t(P),null,{default:a(()=>[v("ul",yt,[(d(!0),u(k,null,I(n.lines,(f,y)=>(d(),u("li",{key:(f.id||f.outputLabel)+"|"+y},[v("span",bt,p(f.outputLabel),1),v("strong",null,p(we(f.amount)),1),v("small",_t,p(new Date(f.createdAt).toLocaleString()),1)]))),128))])]),_:2},1024),l(t(P),{class:"text-center"},{default:a(()=>[v("ul",gt,[(d(!0),u(k,null,I(n.lines,(f,y)=>(d(),u("li",{key:"dbg|"+(f.id||f.outputLabel)+"|"+y,class:"mb-1"},[v("button",{class:"btn btn-sm btn-outline-secondary",title:"Preview payload",onClick:b=>Oe(s.planId,n,f)},[l(o,{icon:t(We),size:"xl",style:{"--ci-primary-color":"green"}},null,8,["icon"])],8,wt)]))),128))])]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]))),128))]))]),_:1})]),_:1}),l(t(re),{visible:z.value,onClose:e[9]||(e[9]=s=>z.value=!1),alignment:"center",backdrop:"static"},{default:a(()=>[l(t(se),null,{default:a(()=>[l(t(ne),null,{default:a(()=>e[42]||(e[42]=[i("Generate Comp Statement",-1)])),_:1,__:[42]})]),_:1}),l(t(oe),null,{default:a(()=>[e[47]||(e[47]=v("div",{class:"mb-2 text-muted"},"Select plan(s) and record scope(s) to include:",-1)),Y.value.length?(d(),u("div",kt,[l(t($e),{modelValue:D.value,"onUpdate:modelValue":e[5]||(e[5]=s=>D.value=s),placeholder:"Filter plans…",class:"mb-2",disabled:$.value},null,8,["modelValue","disabled"]),l(t(ve),{for:"planSelectMulti",class:"mb-1"},{default:a(()=>e[43]||(e[43]=[i("Plans",-1)])),_:1,__:[43]}),l(t(fe),{id:"planSelectMulti",multiple:"",size:Ne.value,modelValue:ge.value,"onUpdate:modelValue":e[6]||(e[6]=s=>ge.value=s),disabled:$.value||!Y.value.length,style:{"max-height":"260px",overflow:"auto"}},{default:a(()=>[(d(!0),u(k,null,I(Y.value,s=>(d(),u("option",{key:s.id??s.planId,value:s.planId,disabled:!(s!=null&&s.planId)},p((s==null?void 0:s.name)??"Unnamed")+" (v"+p((s==null?void 0:s.version)??"?")+") ",9,St))),128))]),_:1},8,["size","modelValue","disabled"]),l(t(ve),{for:"scopeSelectMulti",class:"mb-1 mt-3"},{default:a(()=>e[44]||(e[44]=[i("Record Scopes",-1)])),_:1,__:[44]}),l(t(fe),{id:"scopeSelectMulti",multiple:"",size:Math.min(8,Math.max(4,(x.value||[]).length||4)),modelValue:U.value,"onUpdate:modelValue":e[7]||(e[7]=s=>U.value=s),disabled:$.value||J.value,style:{"max-height":"220px",overflow:"auto"}},{default:a(()=>[(d(!0),u(k,null,I(x.value,s=>(d(),u("option",{key:s,value:s},p(s),9,At))),128))]),_:1},8,["size","modelValue","disabled"]),J.value?(d(),u("small",xt,[l(t(h),{size:"sm",class:"me-1"}),e[45]||(e[45]=i("Loading record scopes… ",-1))])):K.value?(d(),u("small",It,p(K.value),1)):(d(),u("small",jt,e[46]||(e[46]=[i(" Select one or more scopes (defaults to ",-1),v("strong",null,"ACTUAL",-1),i(" if none selected). ",-1)])))])):(d(),u("div",Ct," This participant has no "+p(g.value?"active":"archived")+" plans. ",1))]),_:1,__:[47]}),l(t(ie),null,{default:a(()=>[l(t(_),{color:"secondary",onClick:e[8]||(e[8]=s=>z.value=!1),disabled:$.value},{default:a(()=>e[48]||(e[48]=[i("Cancel",-1)])),_:1,__:[48]},8,["disabled"]),l(t(_),{color:"primary",onClick:Re,disabled:$.value||!M.value.size},{default:a(()=>[$.value?(d(),H(t(h),{key:0,size:"sm",class:"me-2"})):B("",!0),e[49]||(e[49]=i(" Generate Statement ",-1))]),_:1,__:[49]},8,["disabled"])]),_:1})]),_:1},8,["visible"]),l(t(re),{visible:E.value,onClose:e[12]||(e[12]=s=>E.value=!1)},{default:a(()=>[l(t(se),null,{default:a(()=>[l(t(ne),null,{default:a(()=>e[50]||(e[50]=[i("Attach Plan",-1)])),_:1,__:[50]})]),_:1}),l(t(oe),null,{default:a(()=>[l(t(Ye),null,{default:a(()=>[v("div",Pt,[l(t(ve),{for:"planSelectSingle"},{default:a(()=>e[51]||(e[51]=[i("Available Plans",-1)])),_:1,__:[51]}),l(t(fe),{id:"planSelectSingle",modelValue:F.value,"onUpdate:modelValue":e[10]||(e[10]=s=>F.value=s)},{default:a(()=>[e[52]||(e[52]=v("option",{value:""},"Select a plan…",-1)),(d(!0),u(k,null,I(_e.value,s=>(d(),u("option",{key:s.id,value:s.id},p(s.name)+" (v"+p(s.version)+")",9,$t))),128))]),_:1,__:[52]},8,["modelValue"])])]),_:1})]),_:1}),l(t(ie),null,{default:a(()=>[l(t(_),{color:"secondary",onClick:e[11]||(e[11]=s=>E.value=!1)},{default:a(()=>e[53]||(e[53]=[i("Cancel",-1)])),_:1,__:[53]}),l(t(_),{color:"primary",disabled:!F.value,onClick:Ee},{default:a(()=>e[54]||(e[54]=[i("Attach",-1)])),_:1,__:[54]},8,["disabled"])]),_:1})]),_:1},8,["visible"]),l(t(re),{visible:q.value,onClose:e[14]||(e[14]=s=>q.value=!1)},{default:a(()=>[l(t(se),null,{default:a(()=>[l(t(ne),null,{default:a(()=>e[55]||(e[55]=[i("Delete participant?",-1)])),_:1,__:[55]})]),_:1}),l(t(oe),null,{default:a(()=>[e[56]||(e[56]=i(" This cannot be undone. Continue? ",-1)),G.value?(d(),u("div",Lt,p(G.value),1)):B("",!0)]),_:1,__:[56]}),l(t(ie),null,{default:a(()=>[l(t(_),{color:"secondary",onClick:e[13]||(e[13]=s=>q.value=!1)},{default:a(()=>e[57]||(e[57]=[i("Cancel",-1)])),_:1,__:[57]}),l(t(_),{color:"danger",disabled:Z.value,onClick:Ue},{default:a(()=>[Z.value?(d(),H(t(h),{key:0,size:"sm",class:"me-2"})):B("",!0),e[58]||(e[58]=i(" Delete ",-1))]),_:1,__:[58]},8,["disabled"])]),_:1})]),_:1},8,["visible"]),l(t(re),{visible:me.value,size:"xl",alignment:"center",backdrop:"static",onClose:Ae,class:"wide-modal"},{default:a(()=>[l(t(se),null,{default:a(()=>[l(t(ne),null,{default:a(()=>e[59]||(e[59]=[i("Payout Payload",-1)])),_:1,__:[59]})]),_:1}),l(t(oe),null,{default:a(()=>[ce.value?(d(),u("div",ht,[l(t(h),{size:"sm",class:"me-2"}),e[60]||(e[60]=i(" Loading payload… ",-1))])):W.value?(d(),H(m,{key:1,color:"danger"},{default:a(()=>[i(p(W.value),1)]),_:1})):(d(),u("div",Dt,[V.value?(d(),u("iframe",{key:0,srcdoc:V.value,class:"preview-frame"},null,8,Nt)):(d(),u("pre",Tt,p(X.value),1))]))]),_:1}),l(t(ie),null,{default:a(()=>[l(t(_),{color:"dark",onClick:Ae},{default:a(()=>e[61]||(e[61]=[i("Close",-1)])),_:1,__:[61]})]),_:1})]),_:1},8,["visible"])])):(d(),u("div",tt,"Not found."))])}}};export{Jt as default};
