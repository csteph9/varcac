import{r as d,o as B,c as r,d as c,a,b as l,u as s,h as g,C as k,l as w,e as i,t as x,F as H,f as b,q as R,R as V,p as F,i as h,k as o}from"./index-CFGD_Gi7.js";import{C}from"./CAlert-DAczoeYR.js";import{C as z}from"./CButton-Bar-IVn5.js";import{C as K}from"./CCardHeader-j1dVyNP9.js";import{C as N}from"./CFormInput-vGO62AtJ.js";import{a as E,C as O}from"./CRow-CQIQrd1B.js";import{C as S}from"./CSpinner-B_QOP7IZ.js";const U={class:"px-3 py-4"},q={key:0,class:"d-flex align-items-center text-body-secondary mb-2"},L={class:"mb-2"},$={class:"d-flex align-items-center gap-2"},D={key:0},M={key:1},T={key:0,class:"mt-2"},Y={key:1,class:"mt-2"},j={key:2,class:"form-text text-danger mt-2"},ae={__name:"StatementHubConfig",setup(G){const u=d(""),p=d(!0),v=d(""),m=d(!1),f=d(""),y=d(!1);async function I(n){const e=`/api/settings/${encodeURIComponent(n)}`,{data:t,status:_}=await h.get(e,{withCredentials:!0});return _===204||!t?null:t.setting_value??t.value??null}async function A(){var n,e;p.value=!0,v.value="";try{const t=await I("statements_hub_api_key");u.value=t||""}catch(t){v.value=((e=(n=t==null?void 0:t.response)==null?void 0:n.data)==null?void 0:e.error)||(t==null?void 0:t.message)||"Failed to load API key."}finally{p.value=!1}}async function P(){var n,e;f.value="",y.value=!1,m.value=!0;try{await h.put(`/api/settings/${encodeURIComponent("statements_hub_api_key")}`,{setting_value:u.value},{withCredentials:!0}),y.value=!0}catch(t){f.value=((e=(n=t==null?void 0:t.response)==null?void 0:n.data)==null?void 0:e.error)||(t==null?void 0:t.message)||"Failed to save API key."}finally{m.value=!1}}return B(A),(n,e)=>{const t=R("BR");return o(),r("div",U,[e[6]||(e[6]=c("h1",{class:"h4 mb-3"},"Statement Hub Configuration",-1)),e[7]||(e[7]=c("p",{class:"text-body-secondary mb-4"}," You can register an account and generate an API key at https://admin.varcac.com. Once you have your API key, you'll be able to publish generated statements to https://statementhub.varcar.com. ",-1)),a(s(O),{class:"g-4"},{default:l(()=>[a(s(E),{xs:"12",md:"8",lg:"6"},{default:l(()=>[a(s(g),null,{default:l(()=>[a(s(K),null,{default:l(()=>e[1]||(e[1]=[c("strong",null,"API Key",-1)])),_:1,__:[1]}),a(s(k),null,{default:l(()=>[p.value?(o(),r("div",q,[a(s(S),{size:"sm",class:"me-2"}),e[2]||(e[2]=i(" Loading… ",-1))])):v.value?(o(),w(s(C),{key:1,color:"danger",class:"mb-3"},{default:l(()=>[i(x(v.value),1)]),_:1})):(o(),r(H,{key:2},[c("div",L,[a(s(N),{type:"text",modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=_=>u.value=_),placeholder:"Paste API key here",disabled:m.value,autocomplete:"off"},null,8,["modelValue","disabled"])]),c("div",$,[a(s(z),{color:"dark",size:"sm",disabled:m.value,onClick:P},{default:l(()=>[m.value?(o(),r("span",D,[a(s(S),{size:"sm",class:"me-2"}),e[3]||(e[3]=i(" Saving…",-1))])):(o(),r("span",M,"Save"))]),_:1},8,["disabled"])]),f.value?(o(),r("div",T,[a(s(C),{color:"danger",class:"mb-0"},{default:l(()=>[i(x(f.value),1)]),_:1})])):b("",!0),y.value?(o(),r("div",Y,[a(s(C),{color:"success",class:"mb-0"},{default:l(()=>e[4]||(e[4]=[i("API key saved.",-1)])),_:1,__:[4]})])):b("",!0),u.value?b("",!0):(o(),r("div",j," API key required to enable the Statement Hub button. "))],64))]),_:1})]),_:1}),a(t),a(s(g),null,{default:l(()=>[a(s(k),null,{default:l(()=>[a(s(V),{class:F(["btn btn-secondary btn-sm",{disabled:!u.value}]),to:{name:"StatementHub"},"aria-disabled":!u.value,title:"Open Statement Hub"},{default:l(()=>e[5]||(e[5]=[i(" Open Statement Hub ",-1)])),_:1,__:[5]},8,["class","aria-disabled"])]),_:1})]),_:1})]),_:1})]),_:1})])}}};export{ae as default};
