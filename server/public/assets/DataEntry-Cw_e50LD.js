import{r as p,o as S,c as d,a,b as o,u as l,e as i,C as c,m as x,d as f,s as r,F as b,g as I,q as F,h as B,i as v,j as L,k as s,t as u}from"./index-CFGD_Gi7.js";import{C as R}from"./CButton-Bar-IVn5.js";import{C as U}from"./CCardHeader-j1dVyNP9.js";import{C as E}from"./CForm-8Di4je1x.js";import{C as y}from"./CFormInput-vGO62AtJ.js";import{C as w}from"./CFormSelect-BXUyUJls.js";import{C as M,a as m}from"./CRow-CQIQrd1B.js";const P={class:"p-3"},T=["value"],j=["value"],q={class:"d-flex gap-2 mt-4"},X={__name:"DataEntry",setup(A){const g=L(),_=p([]),C=p([]),n=p({participantId:"",elementDefinitionId:"",metricDate:"",value:""});S(async()=>{const[D,e]=await Promise.all([v.get("/api/participants",{withCredentials:!0}),v.get("/api/element-definitions",{withCredentials:!0})]);_.value=D.data||[],C.value=e.data||[]});const V=()=>n.value.participantId&&n.value.elementDefinitionId&&n.value.metricDate&&n.value.value!=="",N=async()=>{V()&&(await v.post("/api/metrics",{participantId:Number(n.value.participantId),elementDefinitionId:Number(n.value.elementDefinitionId),metricDate:n.value.metricDate,value:Number(n.value.value)},{withCredentials:!0}),alert("Value saved"),g.push({name:"DataList"}))};return(D,e)=>{const k=F("router-link");return s(),d("div",P,[a(l(B),null,{default:o(()=>[a(l(U),{class:"fw-semibold"},{default:o(()=>e[4]||(e[4]=[i("Add Value",-1)])),_:1,__:[4]}),a(l(c),null,{default:o(()=>[a(l(E),{onSubmit:x(N,["prevent"])},{default:o(()=>[a(l(M),{class:"g-3"},{default:o(()=>[a(l(m),{md:"6"},{default:o(()=>[a(l(r),null,{default:o(()=>e[5]||(e[5]=[i("Participant",-1)])),_:1,__:[5]}),a(l(w),{modelValue:n.value.participantId,"onUpdate:modelValue":e[0]||(e[0]=t=>n.value.participantId=t)},{default:o(()=>[e[6]||(e[6]=f("option",{value:"",disabled:""},"Select participant…",-1)),(s(!0),d(b,null,I(_.value,t=>(s(),d("option",{key:t.id,value:t.id},u(t.firstName)+" "+u(t.lastName)+" ("+u(t.employeeId)+") ",9,T))),128))]),_:1,__:[6]},8,["modelValue"])]),_:1}),a(l(m),{md:"6"},{default:o(()=>[a(l(r),null,{default:o(()=>e[7]||(e[7]=[i("Element",-1)])),_:1,__:[7]}),a(l(w),{modelValue:n.value.elementDefinitionId,"onUpdate:modelValue":e[1]||(e[1]=t=>n.value.elementDefinitionId=t)},{default:o(()=>[e[8]||(e[8]=f("option",{value:"",disabled:""},"Select element…",-1)),(s(!0),d(b,null,I(C.value,t=>(s(),d("option",{key:t.id,value:t.id},u(t.name)+" ("+u(t.elementType)+" · "+u(t.unit)+") ",9,j))),128))]),_:1,__:[8]},8,["modelValue"])]),_:1}),a(l(m),{md:"4"},{default:o(()=>[a(l(r),null,{default:o(()=>e[9]||(e[9]=[i("Date",-1)])),_:1,__:[9]}),a(l(y),{type:"date",modelValue:n.value.metricDate,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value.metricDate=t)},null,8,["modelValue"])]),_:1}),a(l(m),{md:"4"},{default:o(()=>[a(l(r),null,{default:o(()=>e[10]||(e[10]=[i("Value",-1)])),_:1,__:[10]}),a(l(y),{modelValue:n.value.value,"onUpdate:modelValue":e[3]||(e[3]=t=>n.value.value=t),placeholder:"e.g. 3 or 2500.00"},null,8,["modelValue"])]),_:1})]),_:1}),f("div",q,[a(l(R),{type:"submit",color:"primary",disabled:!V()},{default:o(()=>e[11]||(e[11]=[i("Save",-1)])),_:1,__:[11]},8,["disabled"]),a(k,{class:"btn btn-secondary",to:{name:"DataList"}},{default:o(()=>e[12]||(e[12]=[i("Cancel",-1)])),_:1,__:[12]})])]),_:1})]),_:1})]),_:1})])}}};export{X as default};
