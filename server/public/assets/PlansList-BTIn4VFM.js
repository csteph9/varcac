import{r as p,o as S,w as B,c as v,a as l,b as a,u as t,d as D,e as n,C as x,f as P,F as $,g as E,t as u,h as N,i as k,j as V,k as f,l as F,m as c}from"./index-CFGD_Gi7.js";import{C}from"./CButton-Bar-IVn5.js";import{C as H}from"./CButtonGroup-BmNVzGeG.js";import{C as L}from"./CCardHeader-j1dVyNP9.js";import{C as j}from"./CSpinner-B_QOP7IZ.js";import{C as z,a as I,b as g,c as i,d as M,e as d}from"./CTable-D8-Qdao0.js";const O={class:"p-3"},R={key:0,class:"py-3"},q={key:1},G={key:0,class:"text-muted"},Z={__name:"PlansList",setup(J){const T=V(),m=p(!0),_=p([]),r=p(!0),y=async()=>{m.value=!0;try{const{data:o}=await k.get(`/api/plans?isActive=${r.value?1:0}`,{withCredentials:!0});_.value=Array.isArray(o)?o:[]}finally{m.value=!1}};S(y),B(r,y);const b=o=>T.push({name:"PlanDetail",params:{id:o}}),A=async o=>{if(confirm("Delete this plan? All attached elements will be detached. This cannot be undone."))try{await k.delete(`/api/plans/${o}`,{withCredentials:!0}),_.value=_.value.filter(e=>e.id!==o)}catch(e){console.error(e),alert("Error deleting plan.")}};return(o,e)=>(f(),v("div",O,[l(t(N),null,{default:a(()=>[l(t(L),{class:"fw-semibold d-flex align-items-center justify-content-between"},{default:a(()=>[e[4]||(e[4]=D("span",null,"Plans",-1)),l(t(H),{size:"sm"},{default:a(()=>[l(t(C),{color:r.value?"primary":"secondary",onClick:e[0]||(e[0]=s=>r.value=!0)},{default:a(()=>e[2]||(e[2]=[n("Active",-1)])),_:1,__:[2]},8,["color"]),l(t(C),{color:r.value?"secondary":"primary",onClick:e[1]||(e[1]=s=>r.value=!1)},{default:a(()=>e[3]||(e[3]=[n("Archived",-1)])),_:1,__:[3]},8,["color"])]),_:1})]),_:1,__:[4]}),l(t(x),null,{default:a(()=>[m.value?(f(),v("div",R,[l(t(j))])):(f(),v("div",q,[l(t(z),{hover:"",responsive:""},{default:a(()=>[l(t(I),null,{default:a(()=>[l(t(g),null,{default:a(()=>[l(t(i),null,{default:a(()=>e[5]||(e[5]=[n("Name",-1)])),_:1,__:[5]}),l(t(i),null,{default:a(()=>e[6]||(e[6]=[n("Version",-1)])),_:1,__:[6]}),l(t(i),null,{default:a(()=>e[7]||(e[7]=[n("Effective Start",-1)])),_:1,__:[7]}),l(t(i),null,{default:a(()=>e[8]||(e[8]=[n("Effective End",-1)])),_:1,__:[8]}),l(t(i),null,{default:a(()=>e[9]||(e[9]=[n("Payout",-1)])),_:1,__:[9]}),l(t(i),null,{default:a(()=>e[10]||(e[10]=[n("Created",-1)])),_:1,__:[10]}),l(t(i),null,{default:a(()=>e[11]||(e[11]=[n("Actions",-1)])),_:1,__:[11]})]),_:1})]),_:1}),l(t(M),null,{default:a(()=>[(f(!0),v($,null,E(_.value,s=>(f(),F(t(g),{key:s.id,role:"button"},{default:a(()=>[l(t(d),null,{default:a(()=>[n(u(s.name),1)]),_:2},1024),l(t(d),null,{default:a(()=>[n(u(s.version),1)]),_:2},1024),l(t(d),null,{default:a(()=>[n(u(new Date(s.effectiveStart).toISOString().split("T")[0]||"—"),1)]),_:2},1024),l(t(d),null,{default:a(()=>[n(u(new Date(s.effectiveEnd).toISOString().split("T")[0]||"—"),1)]),_:2},1024),l(t(d),{role:"button",onClick:w=>b(s.id)},{default:a(()=>[n(u(s.payoutFrequency||"—"),1)]),_:2},1032,["onClick"]),l(t(d),null,{default:a(()=>[n(u(new Date(s.createdAt).toLocaleString()),1)]),_:2},1024),l(t(d),null,{default:a(()=>[l(t(C),{class:"btn btn-sm btn-outline-primary me-2",onClick:c(w=>b(s.id),["stop"])},{default:a(()=>e[12]||(e[12]=[n("View",-1)])),_:2,__:[12]},1032,["onClick"]),e[14]||(e[14]=n("  ",-1)),l(t(C),{color:"danger",size:"sm",onClick:c(w=>A(s.id),["stop"])},{default:a(()=>e[13]||(e[13]=[n("Delete",-1)])),_:2,__:[13]},1032,["onClick"])]),_:2,__:[14]},1024)]),_:2},1024))),128))]),_:1})]),_:1}),_.value.length===0?(f(),v("div",G," No "+u(r.value?"active":"archived")+" plans. ",1)):P("",!0)]))]),_:1})]),_:1})]))}};export{Z as default};
