import{r as v,o as A,v as B,c as r,a as e,w as a,u as l,b as C,e as o,t as u,n as S,C as V,k as b,F as D,f as L,g as N,h as c,j as i}from"./index-DpVV47OG.js";import{C as h}from"./CButton-y8u4-JDy.js";import{C as E}from"./CCardHeader-Bqpplymn.js";import{C as P}from"./CFormInput-CfCksTGb.js";import{C as F,a as H}from"./CRow-C4SP1EIB.js";import{C as j}from"./CSpinner-B-jNG_5h.js";import{a as R,b as x,c as m,d as $,C as q,e as p}from"./CTable-8I02-EpL.js";const z={class:"p-3"},I={class:"text-muted"},M={key:0,class:"py-3"},U={class:"badge text-bg-secondary"},W={key:0},G={key:1},J={key:2,class:"text-muted"},lt={__name:"ComputationList",setup(K){const _=v(!0),d=v([]),y=v("");async function g(){_.value=!0;try{const{data:s}=await c.get("/api/computations",{withCredentials:!0});d.value=Array.isArray(s)?s:s.computations||[]}finally{_.value=!1}}A(g);const w=B(()=>{const s=y.value.trim().toLowerCase();return s?d.value.filter(t=>[t.name,t.scope,t.template].filter(Boolean).some(f=>String(f).toLowerCase().includes(s))):d.value});async function k(s){confirm("Delete this computation? This cannot be undone.")&&(await c.delete(`/api/computations/${s}`,{withCredentials:!0}),d.value=d.value.filter(t=>t.id!==s),alert("Computation deleted."))}return(s,t)=>{const f=S("router-link");return i(),r("div",z,[e(l(N),null,{default:a(()=>[e(l(E),{class:"fw-semibold d-flex justify-content-between align-items-center"},{default:a(()=>[C("div",null,[t[1]||(t[1]=o("Computations ",-1)),C("small",I,"("+u(d.value.length)+")",1)]),e(f,{class:"btn btn-primary",to:{name:"ComputationAdd"}},{default:a(()=>t[2]||(t[2]=[o("Add Computation",-1)])),_:1,__:[2]})]),_:1}),e(l(V),null,{default:a(()=>[e(l(F),{class:"g-3 mb-3"},{default:a(()=>[e(l(H),{md:"6"},{default:a(()=>[e(l(P),{modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=n=>y.value=n),placeholder:"Search by name, scope, or template..."},null,8,["modelValue"])]),_:1})]),_:1}),_.value?(i(),r("div",M,[e(l(j))])):w.value.length?(i(),b(l(q),{key:1,hover:"",responsive:""},{default:a(()=>[e(l(R),null,{default:a(()=>[e(l(x),null,{default:a(()=>[e(l(m),{style:{"min-width":"220px"}},{default:a(()=>t[3]||(t[3]=[o("Name",-1)])),_:1,__:[3]}),e(l(m),{style:{"min-width":"120px"}},{default:a(()=>t[4]||(t[4]=[o("Scope",-1)])),_:1,__:[4]}),e(l(m),{style:{"min-width":"360px"}},{default:a(()=>t[5]||(t[5]=[o("Template",-1)])),_:1,__:[5]}),e(l(m),{style:{"min-width":"160px"}},{default:a(()=>t[6]||(t[6]=[o("Created",-1)])),_:1,__:[6]}),e(l(m),{style:{"min-width":"140px"}},{default:a(()=>t[7]||(t[7]=[o("Actions",-1)])),_:1,__:[7]})]),_:1})]),_:1}),e(l($),null,{default:a(()=>[(i(!0),r(D,null,L(w.value,(n,T)=>(i(),b(l(x),{key:n.id??n.name??T},{default:a(()=>[e(l(p),{class:"fw-semibold"},{default:a(()=>[o(u(n.name),1)]),_:2},1024),e(l(p),null,{default:a(()=>[C("span",U,u(n.scope==="plan"?"Entire Plan Window":"Per Payout Period"),1)]),_:2},1024),e(l(p),{class:"text-truncate",style:{"max-width":"460px"}},{default:a(()=>[n.template?(i(),r("code",W,u(n.template),1)):(i(),r("span",G,"—"))]),_:2},1024),e(l(p),null,{default:a(()=>[o(u(n.createdAt?new Date(n.createdAt).toLocaleString():"—"),1)]),_:2},1024),e(l(p),null,{default:a(()=>[e(f,{class:"btn btn-sm btn-outline-primary me-2",to:{name:"ComputationEdit",params:{id:n.id}}},{default:a(()=>t[8]||(t[8]=[o("Edit",-1)])),_:2,__:[8]},1032,["to"]),e(l(h),{size:"sm",color:"danger",onClick:O=>k(n.id)},{default:a(()=>t[9]||(t[9]=[o("Delete",-1)])),_:2,__:[9]},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})):(i(),r("div",J,t[10]||(t[10]=[o("No computations found. Create one with ",-1),C("strong",null,"Add Computation",-1),o(".",-1)])))]),_:1})]),_:1})])}}};export{lt as default};
